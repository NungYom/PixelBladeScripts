-- รองรับ GUI ใน Executor
local guiParent = gethui and gethui() or game:FindFirstChild("CoreGui") or game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")

-- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ExecutorUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = guiParent

-- ฟังก์ชันสร้างปุ่ม
local function createButton(name, posY, color, callback)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 120, 0, 40)
	btn.Position = UDim2.new(0, 20, 0, posY)
	btn.Text = name
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 20
	btn.Parent = ScreenGui
	btn.MouseButton1Click:Connect(callback)
	return btn
end

-- === LOOP 1 ===
local isLooping = false
local loopThread

local function startInvokeLoop()
	loopThread = coroutine.create(function()
		while isLooping do
			for i = 1, 11 do
				if not isLooping then break end
				local args = {
					"\233\162\134\229\143\150\229\156\168\231\186\191\229\165\150\229\138\177",
					i
				}
				pcall(function()
					game:GetService("ReplicatedStorage"):WaitForChild("Msg"):WaitForChild("RemoteFunction"):InvokeServer(unpack(args))
				end)
				wait(1)
			end
		end
	end)
	coroutine.resume(loopThread)
end

local btnStart = createButton("StartLoop", 0.05, Color3.fromRGB(60, 180, 75), function()
	isLooping = not isLooping
	btnStart.Text = isLooping and "StopLoop" or "StartLoop"
	btnStart.BackgroundColor3 = isLooping and Color3.fromRGB(200, 60, 60) or Color3.fromRGB(60, 180, 75)
	if isLooping then startInvokeLoop() end
end)

-- === LOOP 2 ===
local isKilling = false
local killThread

local function getClosestPlayer(radius)
	local lp = game.Players.LocalPlayer
	local myChar = lp.Character
	if not (myChar and myChar:FindFirstChild("HumanoidRootPart")) then return nil end
	local myPos = myChar.HumanoidRootPart.Position

	local closest, minDist = nil, radius
	for _, p in ipairs(game.Players:GetPlayers()) do
		if p ~= lp and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
			local dist = (p.Character.HumanoidRootPart.Position - myPos).Magnitude
			if dist < minDist then
				minDist = dist
				closest = p
			end
		end
	end
	return closest
end

local function startKillLoop()
	killThread = coroutine.create(function()
		while isKilling do
			local target = getClosestPlayer(100)
			if target then
				local args = {
					"\231\142\169\229\174\182\233\128\137\230\139\169\231\155\174\230\160\135",
					{ target }
				}
				pcall(function()
					game:GetService("ReplicatedStorage"):WaitForChild("Msg"):WaitForChild("RemoteEvent"):FireServer(unpack(args))
				end)
			end
			wait(0.5)
		end
	end)
	coroutine.resume(killThread)
end

local btnKill = createButton("Loop Kill", 0.15, Color3.fromRGB(80, 80, 220), function()
	isKilling = not isKilling
	btnKill.Text = isKilling and "Stop Kill" or "Loop Kill"
	btnKill.BackgroundColor3 = isKilling and Color3.fromRGB(200, 60, 60) or Color3.fromRGB(80, 80, 220)
	if isKilling then startKillLoop() end
end)
