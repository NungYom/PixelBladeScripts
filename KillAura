local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

local function waitForCharacter()
    if not player.Character or not player.Character.Parent then
        player.CharacterAdded:Wait()
    end
    local char = player.Character
    local hrp = char:WaitForChild("HumanoidRootPart")
    return char, hrp
end

local function waitForCheckpoints()
    local folder
    repeat
        folder = workspace:FindFirstChild("Checkpoints")
        task.wait(0.5)
    until folder
    return folder
end

local tweenTime = 2
local waitTime = 0.5

local function tweenToPosition(hrp, pos)
    local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(pos)})
    tween:Play()
    tween.Completed:Wait()
    task.wait(waitTime)
end

local function tweenToPart(hrp, checkpointsFolder, partName)
    local part = checkpointsFolder:FindFirstChild(tostring(partName))
    if part then
        tweenToPosition(hrp, part.Position + Vector3.new(0, 3, 0))
    end
end

task.spawn(function()
    local character, hrp = waitForCharacter()
    local checkpointsFolder = waitForCheckpoints()

    while true do
        tweenToPosition(hrp, Vector3.new(448,1470,5145))
        tweenToPart(hrp, checkpointsFolder, 1)
        tweenToPosition(hrp, Vector3.new(389,1543,5397))
        tweenToPart(hrp, checkpointsFolder, 2)
        tweenToPosition(hrp, Vector3.new(370,1600,6270))
        for i = 3, 11 do tweenToPart(hrp, checkpointsFolder, i) end
        tweenToPosition(hrp, Vector3.new(217,1915,9782))
        for i = 12, 17 do tweenToPart(hrp, checkpointsFolder, i) end
        tweenToPosition(hrp, Vector3.new(-76,2232,11084))
        for i = 18, 30 do tweenToPart(hrp, checkpointsFolder, i) end
        tweenToPosition(hrp, Vector3.new(101,2630,12545))
        tweenToPosition(hrp, Vector3.new(-79,2845,13234))
        tweenToPosition(hrp, Vector3.new(-42,2865,13354))
        tweenToPosition(hrp, Vector3.new(41,2875,13611))
        tweenToPosition(hrp, Vector3.new(95,2879,13668))

        local args = {"reset_request"}
        ReplicatedStorage:WaitForChild("ResetBasecampEvent"):FireServer(unpack(args))

        task.wait(2)
    end
end)
