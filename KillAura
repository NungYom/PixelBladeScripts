-- GUI AutoFarm + AutoSellAll สำหรับ Delta Executor
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HRP = Character:WaitForChild("HumanoidRootPart")

-- GUI
local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
ScreenGui.Name = "AutoFarmGUI"

local function createButton(text, position)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0, 200, 0, 50)
	btn.Position = position
	btn.Text = text
	btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.TextScaled = true
	btn.Parent = ScreenGui
	return btn
end

-- Toggle Variables
local autoSell = false
local autoFarm4 = false

-- Auto Sell Button
local sellBtn = createButton("Auto Sell All: OFF", UDim2.new(0, 10, 0, 10))
sellBtn.MouseButton1Click:Connect(function()
	autoSell = not autoSell
	sellBtn.Text = "Auto Sell All: " .. (autoSell and "ON" or "OFF")
end)

-- Auto Farm4 Button
local farmBtn = createButton("Auto Farm4: OFF", UDim2.new(0, 10, 0, 70))
farmBtn.MouseButton1Click:Connect(function()
	autoFarm4 = not autoFarm4
	farmBtn.Text = "Auto Farm4: " .. (autoFarm4 and "ON" or "OFF")
end)

-- Noclip System
local noclip = false
RunService.Stepped:Connect(function()
	if noclip and Character and HRP then
		for _, part in pairs(Character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end
end)

-- Auto Sell Loop
task.spawn(function()
	while true do
		if autoSell then
			pcall(function()
				ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Shop"):WaitForChild("SellAll"):InvokeServer()
			end)
		end
		task.wait(10)
	end
end)

-- Auto Farm4 Loop
task.spawn(function()
	while true do
		if autoFarm4 then
			pcall(function()
				local originalPos = HRP.Position
				noclip = true

				-- วาร์ปไปตำแหน่ง
				HRP.CFrame = CFrame.new(-35, 12, -50)

				-- ตรึง 3 วินาที พร้อม spam Collect
				local startTime = tick()
				while tick() - startTime < 3 do
					local args = {1}
					Character:WaitForChild("Metal Pan"):WaitForChild("Scripts"):WaitForChild("Collect"):InvokeServer(unpack(args))
					task.wait(0.05)
				end

				-- วาร์ปกลับจุดเดิม
				HRP.CFrame = CFrame.new(originalPos)
				noclip = false

				-- รัน Shake 20 วิ
				local shakeStart = tick()
				while tick() - shakeStart < 20 do
					Character:WaitForChild("Metal Pan"):WaitForChild("Scripts"):WaitForChild("Shake"):FireServer()
					task.wait(0.05)
				end
			end)
		end
		task.wait(1)
	end
end)
