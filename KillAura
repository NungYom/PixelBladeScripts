-- ‚úÖ GUI Script with Auto Sell, Auto Farm, Dig Here, Adjustable Timers, Item Detection, and Warp Loop

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")

-- üß± GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "DeltaFarmGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

local function createButton(name, pos, callback)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 120, 0, 30)
    button.Position = pos
    button.Text = name
    button.BackgroundColor3 = Color3.fromRGB(51, 51, 51)
    button.TextColor3 = Color3.new(1, 1, 1)
    button.Parent = ScreenGui
    button.BackgroundTransparency = 0.5
    button.MouseButton1Click:Connect(function()
        callback(button)
    end)
    return button
end

local function createSlider(name, pos, minVal, maxVal, defaultVal, callback)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 120, 0, 20)
    label.Position = pos
    label.Text = name .. ": " .. defaultVal
    label.TextColor3 = Color3.new(1, 1, 1)
    label.BackgroundColor3 = Color3.fromRGB(51, 51, 51)
    label.BackgroundTransparency = 0.5
    label.Parent = ScreenGui

    local slider = Instance.new("TextBox")
    slider.Size = UDim2.new(0, 120, 0, 20)
    slider.Position = pos + UDim2.new(0, 0, 0, 20)
    slider.Text = tostring(defaultVal)
    slider.TextColor3 = Color3.new(0, 0, 0)
    slider.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    slider.BackgroundTransparency = 0.5
    slider.ClearTextOnFocus = false
    slider.Parent = ScreenGui

    slider.FocusLost:Connect(function()
        local val = tonumber(slider.Text)
        if val then
            val = math.clamp(val, minVal, maxVal)
            label.Text = name .. ": " .. val
            callback(val)
        end
    end)

    return slider
end

-- ü™ô Manual Sell Button
createButton("Sell", UDim2.new(0, 10, 0, 10), function()
    pcall(function()
        local hrp = Character:WaitForChild("HumanoidRootPart")
        local originalCFrame = hrp.CFrame

        -- Update originalCFrame after selling
        hrp.CFrame = CFrame.new(-187, -8, 372)

        local sellSuccess = false
        for _ = 1, 10 do
            local success = pcall(function()
                ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Shop"):WaitForChild("SellAll"):InvokeServer()
            end)
            if success then
                sellSuccess = true
                break
            end
            wait(0.1)
        end

        wait(0.25)

        -- Refresh originalCFrame before teleporting back
        Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
        hrp = Character:WaitForChild("HumanoidRootPart")
        hrp.CFrame = originalCFrame
    end)
end)

-- üìç Dig Location Memory
local digPosition = nil
createButton("Dig Here", UDim2.new(0, 10, 0, 50), function()
    digPosition = Character:WaitForChild("HumanoidRootPart").Position
    Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
end)

-- ‚è±Ô∏è Sliders for Timing
local sandTime = 3
local waterTime = 20
createSlider("Sand", UDim2.new(0, 10, 0, 90), 1, 50, 3, function(val) sandTime = val end)
createSlider("Water", UDim2.new(0, 10, 0, 130), 1, 50, 20, function(val) waterTime = val end)

-- ‚öíÔ∏è Auto Farm4
local autoFarm = false
createButton("Auto Farm4", UDim2.new(0, 10, 0, 170), function(button)
    autoFarm = not autoFarm
    button.BackgroundColor3 = autoFarm and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(51, 51, 51)
end)

-- üåã Auto Farm Cave
local autoFarmCave = false
createButton("Auto Farm Cave", UDim2.new(0, 140, 0, 170), function(button)
    autoFarmCave = not autoFarmCave
    button.BackgroundColor3 = autoFarmCave and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(51, 51, 51)
end)

local function getHeldTool()
    return Character:FindFirstChildOfClass("Tool")
end

spawn(function()
    while true do
        if autoFarm and digPosition then
            local originalPos = Character:WaitForChild("HumanoidRootPart").CFrame
            pcall(function()
                Character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(digPosition)
            end)

            local start = tick()
            while tick() - start < sandTime do
                local tool = getHeldTool()
                if tool and tool:FindFirstChild("Scripts") and tool.Scripts:FindFirstChild("Collect") then
                    tool.Scripts.Collect:InvokeServer(1)
                end
                task.wait()
            end

            pcall(function()
                Character:WaitForChild("HumanoidRootPart").CFrame = originalPos
            end)

            local tool = getHeldTool()
            if tool and tool:FindFirstChild("Scripts") then
                local scriptFolder = tool:WaitForChild("Scripts")
                if scriptFolder:FindFirstChild("Pan") then
                    scriptFolder.Pan:InvokeServer()
                end
                local startShake = tick()
                while tick() - startShake < waterTime do
                    if scriptFolder:FindFirstChild("Shake") then
                        scriptFolder.Shake:FireServer()
                    end
                    task.wait()
                end
            end
        elseif autoFarmCave then
            local originalPos = Character:WaitForChild("HumanoidRootPart").CFrame
            pcall(function()
                Character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(-247, -41, 620)
            end)

            local start = tick()
            while tick() - start < sandTime do
                local tool = getHeldTool()
                if tool and tool:FindFirstChild("Scripts") and tool.Scripts:FindFirstChild("Collect") then
                    tool.Scripts.Collect:InvokeServer(1)
                end
                task.wait()
            end

            pcall(function()
                Character:WaitForChild("HumanoidRootPart").CFrame = originalPos
            end)

            local tool = getHeldTool()
            if tool and tool:FindFirstChild("Scripts") then
                local scriptFolder = tool:WaitForChild("Scripts")
                if scriptFolder:FindFirstChild("Pan") then
                    scriptFolder.Pan:InvokeServer()
                end
                local startShake = tick()
                while tick() - startShake < waterTime do
                    if scriptFolder:FindFirstChild("Shake") then
                        scriptFolder.Shake:FireServer()
                    end
                    task.wait()
                end
            end
        end
        task.wait()
    end
end)

-- üåÄ Warp Loop Button
local buffer = require(ReplicatedStorage:WaitForChild("buffer"))
local warpEnabled = false
createButton("1T : OFF", UDim2.new(0, 10, 0, 210), function(button)
    warpEnabled = not warpEnabled
    button.Text = warpEnabled and "1T : ON" or "1T : OFF"
    button.BackgroundColor3 = warpEnabled and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(255, 0, 0)
end)

spawn(function()
    while true do
        if warpEnabled then
            local args = {
                buffer.fromstring("\024"),
                buffer.fromstring("\254\001\000\006\015VortexContainer")
            }
            ReplicatedStorage:WaitForChild("Modules"):WaitForChild("Shared")
                :WaitForChild("Warp"):WaitForChild("Index")
                :WaitForChild("Event"):WaitForChild("Reliable")
                :FireServer(unpack(args))
        end
        wait(1)
    end
end)
